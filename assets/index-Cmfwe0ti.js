import{Q as F,R as s,S as f,T as t,c as e,a7 as z,a8 as B,W as o,_ as u,V as G,a4 as i,a9 as U,aa as H,M as W,x,A as Y,ab as q,X as n,a1 as Q,Y as d,a3 as R,U as T,Z as g,ac as X,P as Z,G as V,$ as J}from"./index-DZH1FvPX.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as O}from"./VChip-Bg6ighyR.js";import{m as D,S as I}from"./StoryItem-CdQC_jDK.js";import{V as p,a as l}from"./VRow-wS-hPdtk.js";import{V as y}from"./VContainer-Dm3Q9-rI.js";import{V as b}from"./VDivider-Cn5E2RE9.js";import{V as ee,a as te,b as ae}from"./VList-DX-qk002.js";import"./VSlideGroup-B6nxZBQL.js";import"./vee-validate.esm-C5MipkAk.js";import"./VMenu-qYNERZNV.js";import"./VTextarea-Bf07jP0W.js";const se={class:"d-flex justify-space-between align-center my-2"},le={__name:"BookCard",props:["_id","image","title","category","mainAuthor","content","chapterName"],setup(r){return(h,w)=>{const S=F("router-link");return s(),f(S,{to:"/stories/"+r._id,style:{"text-decoration":"none"}},{default:t(()=>[e(z,{class:"pa-3 customMargin h-100 me-2 pa-4 rounded-lg",width:"220",style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, 0.2), 0 4px 8px rgba(0, 0, 0, 0.15)"}},{default:t(()=>[e(B,{class:"pa-0 mb-2 cursor-pointer",style:{"font-size":"12px",color:"#4e9194"}},{default:t(()=>{var _;return[o(u((_=r.mainAuthor)==null?void 0:_.username),1)]}),_:1}),e(G,{class:"cursor-pointer rounded-lg",height:"160px",src:r.image,cover:"",style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, 0.2)"}},null,8,["src"]),i("div",se,[e(U,{class:"pa-0 text-subtitle-1 cursor-pointer",style:{width:"130px"}},{default:t(()=>[o(u(r.title),1)]),_:1}),e(O,{density:"compact",color:"primary",label:"",style:{"font-size":"12px",padding:"2px 6px"}},{default:t(()=>[o(u(r.category),1)]),_:1})]),e(H,{class:"pa-0"},{default:t(()=>[o(u(r.content[r.content.length-1].chapterName),1)]),_:1}),e(B,{class:"pa-0 ellipsis-3-lines"},{default:t(()=>[o(u(r.content[0].content[0]),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},M=K(le,[["__scopeId","data-v-eade7f3b"]]),oe={class:"pa-0 px-4"},re=i("h2",null,"收藏故事",-1),ne=i("h2",null,"熱門故事",-1),ce=i("h2",null,"最新故事",-1),ue=i("h2",null,"完結故事",-1),ie={key:1,class:""},de=i("h2",null,"創作資源區",-1),Ve={__name:"index",setup(r){const h=W(),{api:w,apiAuth:S}=X(),_=Z(),E=()=>{h.isLogin?_.push("/createStory"):_.push("/login")},v=x([]),A=x([]),L=x([]),C=x([]),j=x(null),P=c=>{j.value=j.value===c?null:c},m=async()=>{try{const[c,N,a]=await Promise.all([w.get("/story/getPopularStories"),w.get("/story/getNewestStories"),w.get("/story/getCompletedStories")]);if(A.value=c.data.result.data,L.value=N.data.result.data,C.value=a.data.result.data,h.isLogin){const k=await S.get("/story/getBookmarkStories");v.value=k.data.result.data}else v.value=[]}catch(c){console.error("Failed to load stories:",c)}},$=[{to:"/articleArea",icon:"mdi-lightbulb-on-outline",title:"創作指引",color:"#F9A825"}];return Y(()=>{m(),D.on("updateStory",m)}),q(()=>{D.off("updateStory",m)}),(c,N)=>(s(),n("div",null,[e(p,null,{default:t(()=>[e(l,{cols:"12"},{default:t(()=>[e(z,{class:"rounded-0 px-10 py-auto",height:"200px",color:"surface-variant",image:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=2948&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",cover:"",elevation:"5"},{default:t(()=>[e(l,null,{default:t(()=>[e(U,{class:"text-h4 font-weight-bold"},{default:t(()=>[o(" 歡迎來到界筆！ ")]),_:1}),e(B,{class:"font-weight-bold pa-0 py-2 px-4 mb-2",style:{"font-size":"24px","letter-spacing":"12px"}},{default:t(()=>[o(" 探索和創作無限可能的故事 ")]),_:1}),i("div",oe,[e(T,{class:"font-weight-black mr-3 px-4",variant:"elevated",color:"#CCB78E",onClick:E,to:"/createStory"},{default:t(()=>[o(" 立即創作 ")]),_:1}),e(T,{class:"font-weight-black px-4",outlined:"",border:"",variant:"elevated",style:{color:"#ccb78e",border:"1px solid #ccb78e","background-color":"rgba(0, 0, 0, 0.47)"},to:"/category"},{default:t(()=>[o(" 探索故事 ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),Q(h).isLogin?(s(),n(d,{key:0},[v.value.length>0?(s(),f(y,{key:0,style:{padding:"32px"}},{default:t(()=>[e(p,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[re]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-column justify-space-between"},{default:t(()=>[(s(!0),n(d,null,g(v.value,a=>(s(),f(I,V({key:a._id,ref_for:!0},a,{isExpanded:j.value===a._id,onToggle:k=>P(a._id),onUpdate:m}),null,16,["isExpanded","onToggle"]))),128))]),_:1})]),_:1})]),_:1})):R("",!0)],64)):R("",!0),e(y,{style:{padding:"32px"}},{default:t(()=>[e(p,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ne]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-start"},{default:t(()=>[(s(!0),n(d,null,g(A.value,a=>(s(),f(M,V({key:a._id,ref_for:!0},a),null,16))),128))]),_:1})]),_:1})]),_:1}),e(y,{style:{padding:"32px"}},{default:t(()=>[e(p,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ce]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-column justify-space-between"},{default:t(()=>[(s(!0),n(d,null,g(L.value,a=>(s(),f(I,V({key:a._id,ref_for:!0},a,{onUpdate:m}),null,16))),128))]),_:1})]),_:1})]),_:1}),e(y,{style:{padding:"32px"}},{default:t(()=>[e(p,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ue]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-space-between"},{default:t(()=>[C.value.length>0?(s(!0),n(d,{key:0},g(C.value,a=>(s(),f(M,V({key:a._id,ref_for:!0},a),null,16))),128)):(s(),n("div",ie,"尚未有已完結故事"))]),_:1})]),_:1})]),_:1}),e(y,{style:{padding:"32px"}},{default:t(()=>[e(p,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[de]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-space-between py-0"},{default:t(()=>[e(ee,{class:"d-flex justify-space-between w-100 py-0",style:{"background-color":"transparent"}},{default:t(()=>[(s(),n(d,null,g($,(a,k)=>e(te,{key:k,to:a.to,link:""},{prepend:t(()=>[e(J,{size:"80",color:a.color},{default:t(()=>[o(u(a.icon),1)]),_:2},1032,["color"])]),default:t(()=>[e(ae,{style:{"font-size":"20px","font-weight":"bold"},textContent:u(a.title)},null,8,["textContent"])]),_:2},1032,["to"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{Ve as default};
