import{p as ve,bh as ge,g as ye,D as oe,a_ as _e,bk as we,x as B,b9 as be,o as te,aB as he,u as xe,bi as Ve,bj as ne,c as e,G as ie,P as v,r as ke,bl as Ee,ak as Ce,a$ as Pe,bm as Se,a3 as ze,a6 as Te,a7 as u,aa as R,ac as a,at as Ue,ad as t,ao as je,aF as Ie,a9 as p,ap as Be,a8 as g,ag as Z,aw as re,ah as ee,av as D,aj as N,J as b,ae as h,ai as ae,ax as Fe,ay as $e}from"./index-D7Xhxmta.js";import{c as Ae,b as L,g as Me,u as Re,f as O,V as De}from"./vee-validate.esm-DzmRxloW.js";import{v as Ne}from"./index-BhZ4hISZ.js";import{_ as Le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as de}from"./VContainer-MCypQQ9h.js";import{a as ce,V as ue}from"./VList-CML2CvsF.js";import{V as me,a as W,b as Oe,c as se}from"./VTabs-COT8Ud8D.js";import{V as j}from"./VDivider-BsLMrE3_.js";import{a as le,V as r}from"./VRow-D71uz2gf.js";import{m as We,V as fe}from"./VSelectionControl-C0Jn2ZLg.js";import"./VSlideGroup-BdmKZR-h.js";const Ge=ve({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...ge(),...We()},"VSwitch"),G=ye()({name:"VSwitch",inheritAttrs:!1,props:Ge(),emits:{"update:focused":n=>!0,"update:modelValue":n=>!0,"update:indeterminate":n=>!0},setup(n,F){let{attrs:V,slots:d}=F;const k=oe(n,"indeterminate"),x=oe(n,"modelValue"),{loaderClasses:E}=_e(n),{isFocused:y,focus:J,blur:_}=we(n),$=B(),w=be&&window.matchMedia("(forced-colors: active)").matches,q=te(()=>typeof n.loading=="string"&&n.loading!==""?n.loading:n.color),C=he(),H=te(()=>n.id||`switch-${C}`);function P(){k.value&&(k.value=!1)}function S(z){var T,i;z.stopPropagation(),z.preventDefault(),(i=(T=$.value)==null?void 0:T.input)==null||i.click()}return xe(()=>{const[z,T]=Ve(V),i=ne.filterProps(n),A=fe.filterProps(n);return e(ne,ie({class:["v-switch",{"v-switch--flat":n.flat},{"v-switch--inset":n.inset},{"v-switch--indeterminate":k.value},E.value,n.class]},z,i,{modelValue:x.value,"onUpdate:modelValue":U=>x.value=U,id:H.value,focused:y.value,style:n.style}),{...d,default:U=>{let{id:K,messagesId:Q,isDisabled:X,isReadonly:I,isValid:M}=U;const o={model:x,isValid:M};return e(fe,ie({ref:$},A,{modelValue:x.value,"onUpdate:modelValue":[l=>x.value=l,P],id:K.value,"aria-describedby":Q.value,type:"checkbox","aria-checked":k.value?"mixed":void 0,disabled:X.value,readonly:I.value,onFocus:J,onBlur:_},T),{...d,default:l=>{let{backgroundColorClasses:m,backgroundColorStyles:s}=l;return e("div",{class:["v-switch__track",w?void 0:m.value],style:s.value,onClick:S},[d["track-true"]&&e("div",{key:"prepend",class:"v-switch__track-true"},[d["track-true"](o)]),d["track-false"]&&e("div",{key:"append",class:"v-switch__track-false"},[d["track-false"](o)])])},input:l=>{let{inputNode:m,icon:s,backgroundColorClasses:f,backgroundColorStyles:pe}=l;return e(v,null,[m,e("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":s||n.loading},n.inset||w?void 0:f.value],style:n.inset?void 0:pe.value},[d.thumb?e(ke,{defaults:{VIcon:{icon:s,size:"x-small"}}},{default:()=>[d.thumb({...o,icon:s})]}):e(Ee,null,{default:()=>[n.loading?e(Pe,{name:"v-switch",active:!0,color:M.value===!1?void 0:q.value},{default:Y=>d.loader?d.loader(Y):e(Se,{active:Y.isActive,color:Y.color,indeterminate:!0,size:"16",width:"2"},null)}):s&&e(Ce,{key:String(s),icon:s,size:"x-small"},null)]})])])}})}})}),{}}}),c=n=>(Fe("data-v-34d92a3a"),n=n(),$e(),n),Je={class:"smallSidebar mb-3 w-100",style:{"background-color":"white","border-radius":"12px"}},qe={class:"d-flex justify-center"},He={class:"sidebar",style:{"margin-right":"12px","background-color":"white","border-radius":"12px"}},Ke=c(()=>t("h3",{class:"mb-1"},"設定",-1)),Qe={class:"content w-100",style:{"background-color":"white","border-radius":"12px"}},Xe=c(()=>t("div",{class:"d-flex align-center justify-space-between mb-4"},[t("h3",null,"帳號設定")],-1)),Ye={id:"profile",class:"w-md-50 w-100 text-center mx-auto rounded-lg"},Ze=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 暱稱 ",-1)),ea={style:{"font-size":"18px"}},aa=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 暱稱 ",-1)),sa=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 帳號 ",-1)),la={style:{"font-size":"18px"}},ta=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 帳號 ",-1)),oa=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 密碼 ",-1)),na={style:{"font-size":"18px"}},ia=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 新密碼 ",-1)),ra=c(()=>t("label",{class:"form-label",style:{"font-size":"18px"}}," 確認密碼 ",-1)),da=c(()=>t("div",{class:"d-flex align-center justify-space-between mb-4"},[t("h3",null,"通知設定")],-1)),ca={class:"d-flex align-center justify-space-between py-2"},ua={class:"d-flex align-center justify-space-between w-100"},ma=c(()=>t("p",null,"投票通知",-1)),fa=c(()=>t("p",null,"其他使用者投票給你的故事時寄送推播",-1)),pa={class:"d-flex align-center justify-space-between w-100"},va=c(()=>t("p",null,"收藏通知",-1)),ga=c(()=>t("p",null,"您所收藏的故事有更新時會寄送通知",-1)),ya=c(()=>t("div",{class:"d-flex align-center justify-space-between mb-4"},[t("h3",null,"主題設定")],-1)),_a={class:"d-flex align-center justify-space-between py-2"},wa={class:"d-flex align-center justify-space-between w-100"},ba=c(()=>t("p",null,"淺色模式",-1)),ha={class:"d-flex align-center justify-space-between w-100"},xa=c(()=>t("p",null,"深色模式",-1)),Va={__name:"setting",setup(n){const{apiAuth:F}=Ue(),V=ze(),d=B("option-1"),k=Ae({newEmail:L().test("isEmail","使用者信箱格式錯誤",o=>o?Ne.isEmail(o):!0),newUsername:L().min(1,"使用者暱稱長度不符").max(20,"使用者暱稱長度不符"),newPassword:L().min(4,"使用者密碼長度不符").max(20,"使用者密碼長度不符"),passwordConfirm:L().oneOf([Me("newPassword")],"密碼不一致")}),{handleSubmit:x,isSubmitting:E}=Re({validationSchema:k}),{value:y,errorMessage:J}=O("newUsername"),{value:_,errorMessage:$}=O("newEmail"),{value:w,errorMessage:q}=O("newPassword"),{value:C,errorMessage:H}=O("passwordConfirm"),P=B(!1),S=B(!1),z=()=>{P.value=!P.value},T=()=>{S.value=!S.value},i=B([]),A=async()=>{try{const{data:o}=await F.get("/user/profile");i.value=[o.result],i.value[0].newAvatar=i.value[0].avatar,i.value[0].password="********",i.value[0].newUsername=i.value[0].username,i.value[0].newEmail=i.value[0].email,i.value[0].newPassword="",i.value[0].passwordConfirm=""}catch(o){console.log(o)}};A();const U=te(()=>i.value[0]||{}),K=o=>{i.value.forEach(l=>{l.isEditing=!1,l.isEmailToggleEditing=!1,l.passwordisEditing=!1}),o.isEditing=!o.isEditing},Q=o=>{i.value.forEach(l=>{l.isEditing=!1,l.isEmailToggleEditing=!1,l.passwordisEditing=!1}),o.isEmailToggleEditing=!o.isEmailToggleEditing},X=o=>{i.value.forEach(l=>{l.isEditing=!1,l.isEmailToggleEditing=!1,l.passwordisEditing=!1}),o.passwordisEditing=!o.passwordisEditing},I=(o,l)=>{switch(l){case"username":y.value="",o.isEditing=!1;break;case"email":_.value="",o.isEmailToggleEditing=!1;break;case"password":w.value="",C.value="",o.passwordisEditing=!1;break}},M=x(async()=>{var o,l;try{const m={};if(y.value&&y.value!==U.value.username&&(m.username=y.value),_.value&&_.value!==U.value.email&&(m.email=_.value),w.value&&(m.password=w.value),Object.keys(m).length===0){V({text:"沒有任何變更",snackbarProps:{color:"accent"}});return}const s=await F.patch("/user/profile",m);s.data.success?(V({text:"資料修改成功",snackbarProps:{color:"green"}}),A()):V({text:s.data.message||"發生錯誤",snackbarProps:{color:"red"}})}catch(m){V({text:((l=(o=m==null?void 0:m.response)==null?void 0:o.data)==null?void 0:l.message)||"發生錯誤",snackbarProps:{color:"red"}})}});return(o,l)=>{const m=Te("vue-file-agent");return u(),R(de,{class:"d-flex align-center justify-center ma-0 bg-white h-100",style:{"max-width":"100vw","max-height":"100%"}},{default:a(()=>[e(de,{class:"w-100 h-xs-100",style:{padding:"32px"}},{default:a(()=>[t("div",Je,[e(ce,{class:"py-0",dense:""},{default:a(()=>[e(ue,{class:"w-100"},{default:a(()=>[e(me,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=s=>d.value=s),color:"primary",grow:""},{default:a(()=>[e(W,{"prepend-icon":"mdi-cog-outline",text:"帳號設定",value:"option-1"}),e(W,{"prepend-icon":"mdi-bell-outline",text:"通知設定",value:"option-2"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),t("div",qe,[t("div",He,[e(ce,{class:"py-0",dense:""},{default:a(()=>[Ke,e(ue,{class:"d-flex"},{default:a(()=>[e(me,{modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=s=>d.value=s),color:"primary",direction:"vertical"},{default:a(()=>[e(W,{class:"my-1","prepend-icon":"mdi-cog-outline",text:"帳號設定",value:"option-1"}),e(W,{class:"my-1","prepend-icon":"mdi-bell-outline",text:"通知設定",value:"option-2"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),t("div",Qe,[e(Oe,{modelValue:d.value,"onUpdate:modelValue":l[7]||(l[7]=s=>d.value=s)},{default:a(()=>[e(se,{value:"option-1"},{default:a(()=>[Xe,e(j),e(je,{flat:""},{default:a(()=>[e(De,{onSubmit:Ie(p(M),["prevent"]),disabled:p(E)},{default:a(()=>[e(Be,null,{default:a(()=>[t("div",Ye,[e(m,{class:"d-flex justify-center mb-5",accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"上傳大頭照","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},"file-records":o.fileRecords,"onUpdate:fileRecords":l[2]||(l[2]=s=>o.fileRecords=s)},null,8,["file-records"]),e(le,{class:"text-center",style:{padding:"8px"}},{default:a(()=>[(u(!0),g(v,null,Z(i.value,s=>(u(),g(v,{key:s.id},[s.isEditing?(u(),g(v,{key:1},[e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[aa]),_:1}),e(r,{cols:"10",class:"my-auto"},{default:a(()=>[e(D,{class:"form-label",style:{"font-size":"18px"},minlength:"3",maxlength:"20",variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:p(y),"onUpdate:modelValue":l[3]||(l[3]=f=>N(y)?y.value=f:null),"error-messages":p(J)},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",class:"my-auto"},{default:a(()=>[e(b,{variant:"flat",color:"#4E9194",class:"mx-1",onClick:f=>I(s,"username")},{default:a(()=>[h("取消")]),_:2},1032,["onClick"]),e(b,{type:"submit",variant:"flat",color:"#4E9194",class:"mx-1",loading:p(E)},{default:a(()=>[h("保存")]),_:1},8,["loading"])]),_:2},1024)],64)):(u(),g(v,{key:0},[e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[Ze]),_:1}),e(r,{cols:"8",class:"my-auto"},{default:a(()=>[t("p",ea,ee(s.username),1)]),_:2},1024)],64)),s.isEditing?ae("",!0):(u(),R(r,{key:2,cols:"2",class:"my-auto pa-0"},{default:a(()=>[e(b,{onClick:f=>K(s),variant:"flat",color:"#4E9194",class:"pa-0"},{default:a(()=>[h("編輯")]),_:2},1032,["onClick"])]),_:2},1024))],64))),128))]),_:1}),e(j,{class:"text-center my-3"}),e(le,{class:"text-center",style:{padding:"8px"}},{default:a(()=>[(u(!0),g(v,null,Z(i.value,s=>(u(),g(v,{key:s.id},[s.isEmailToggleEditing?(u(),g(v,{key:1},[e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[ta]),_:1}),e(r,{cols:"10",class:"my-auto"},{default:a(()=>[e(D,{class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:p(_),"onUpdate:modelValue":l[4]||(l[4]=f=>N(_)?_.value=f:null),"error-messages":p($)},null,8,["modelValue","error-messages"])]),_:1}),e(r,{cols:"12",class:"my-auto"},{default:a(()=>[e(b,{variant:"flat",color:"#4E9194",class:"mx-1",onClick:f=>I(s,"email")},{default:a(()=>[h("取消")]),_:2},1032,["onClick"]),e(b,{type:"submit",variant:"flat",color:"#4E9194",class:"mx-1",loading:p(E)},{default:a(()=>[h("保存")]),_:1},8,["loading"])]),_:2},1024)],64)):(u(),g(v,{key:0},[e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[sa]),_:1}),e(r,{cols:"8",class:"my-auto"},{default:a(()=>[t("p",la,ee(s.email),1)]),_:2},1024)],64)),s.isEmailToggleEditing?ae("",!0):(u(),R(r,{key:2,cols:"2",class:"my-auto pa-0"},{default:a(()=>[e(b,{onClick:f=>Q(s),variant:"flat",color:"#4E9194",class:"pa-0"},{default:a(()=>[h("編輯")]),_:2},1032,["onClick"])]),_:2},1024))],64))),128))]),_:1}),e(j,{class:"text-center my-3"}),e(le,{class:"text-center",style:{padding:"8px"}},{default:a(()=>[(u(!0),g(v,null,Z(i.value,s=>(u(),g(v,{key:s.id},[s.passwordisEditing?(u(),g(v,{key:1},[e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[ia]),_:1}),e(r,{cols:"10",class:"my-auto"},{default:a(()=>[e(D,{class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",type:P.value?"text":"password",minlength:"4",maxlength:"20",modelValue:p(w),"onUpdate:modelValue":l[5]||(l[5]=f=>N(w)?w.value=f:null),"error-messages":p(q),"append-inner-icon":P.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":z},null,8,["type","modelValue","error-messages","append-inner-icon"])]),_:1}),e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[ra]),_:1}),e(r,{cols:"10",class:"my-auto"},{default:a(()=>[e(D,{class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",type:S.value?"text":"password",minlength:"4",maxlength:"20",modelValue:p(C),"onUpdate:modelValue":l[6]||(l[6]=f=>N(C)?C.value=f:null),"error-messages":p(H),"append-inner-icon":S.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":T},null,8,["type","modelValue","error-messages","append-inner-icon","onClick:appendInner"])]),_:1}),e(r,{cols:"12",class:"my-auto"},{default:a(()=>[e(b,{variant:"flat",color:"#4E9194",class:"mx-1",onClick:f=>I(s,"password")},{default:a(()=>[h("取消")]),_:2},1032,["onClick"]),e(b,{type:"submit",variant:"flat",color:"#4E9194",class:"mx-1",loading:p(E)},{default:a(()=>[h("保存")]),_:1},8,["loading"])]),_:2},1024)],64)):(u(),g(v,{key:0},[e(r,{cols:"2",class:"my-auto pa-0"},{default:a(()=>[oa]),_:1}),e(r,{cols:"8",class:"my-auto"},{default:a(()=>[t("p",na,ee(s.password),1)]),_:2},1024)],64)),s.passwordisEditing?ae("",!0):(u(),R(r,{key:2,cols:"2",class:"my-auto pa-0"},{default:a(()=>[e(b,{variant:"flat",color:"#4E9194",onClick:f=>X(s)},{default:a(()=>[h("編輯")]),_:2},1032,["onClick"])]),_:2},1024))],64))),128))]),_:1}),e(j,{class:"text-center my-3"})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1}),e(se,{value:"option-2",style:{height:"320px"}},{default:a(()=>[da,e(j),t("div",ca,[e(re,{class:"d-flex flex-column w-100"},{default:a(()=>[t("div",ua,[ma,fa,e(G,{"model-value":!0,color:"primary","hide-details":""})]),t("div",pa,[va,ga,e(G,{"model-value":!0,color:"primary","hide-details":""})])]),_:1})])]),_:1}),e(se,{value:"option-3",style:{height:"450px"}},{default:a(()=>[ya,e(j),t("div",_a,[e(re,{class:"d-flex flex-column w-100"},{default:a(()=>[t("div",wa,[ba,e(G,{"model-value":!0,color:"primary","hide-details":""})]),t("div",ha,[xa,e(G,{"model-value":!1,color:"primary","hide-details":""})])]),_:1})])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1})}}},Fa=Le(Va,[["__scopeId","data-v-34d92a3a"]]);export{Fa as default};
