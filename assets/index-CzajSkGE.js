import{Q as H,R as s,S as _,T as t,c as e,a7 as z,a8 as B,W as o,_ as u,V as W,a4 as i,a9 as U,aa as Y,M as q,x as d,A as Q,ab as X,X as n,a1 as Z,Y as p,a3 as R,U as T,Z as y,ac as J,P as K,G as V,$ as O}from"./index-B1ySa3vZ.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as te}from"./VChip-BqS4VQXF.js";import{m as D,S as I}from"./StoryItem-Cyo2ePfV.js";import{V as f,a as l}from"./VRow-aRsc4bx-.js";import{V as b}from"./VContainer-CgMUdhVE.js";import{V as h}from"./VDivider-BhPiY8Mx.js";import{V as ae,a as se,b as le}from"./VList-D1zm3Ytf.js";import"./VSlideGroup-CHpiL728.js";import"./vee-validate.esm-CmGSlEdC.js";import"./VMenu-qi1tmf6I.js";import"./VTextarea-BItmzKDh.js";const oe={class:"d-flex justify-space-between align-center my-2"},re={__name:"BookCard",props:["_id","image","title","category","mainAuthor","content","chapterName"],setup(r){return(w,m)=>{const S=H("router-link");return s(),_(S,{to:"/stories/"+r._id,style:{"text-decoration":"none"}},{default:t(()=>[e(z,{class:"pa-3 customMargin h-100 me-2 pa-4 rounded-lg",width:"220",style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, 0.2), 0 4px 8px rgba(0, 0, 0, 0.15)"}},{default:t(()=>[e(B,{class:"pa-0 mb-2 cursor-pointer",style:{"font-size":"12px",color:"#4e9194"}},{default:t(()=>{var x;return[o(u((x=r.mainAuthor)==null?void 0:x.username),1)]}),_:1}),e(W,{class:"cursor-pointer rounded-lg",height:"160px",src:r.image,cover:"",style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, 0.2)"}},null,8,["src"]),i("div",oe,[e(U,{class:"pa-0 text-subtitle-1 cursor-pointer",style:{width:"130px"}},{default:t(()=>[o(u(r.title),1)]),_:1}),e(te,{density:"compact",color:"primary",label:"",style:{"font-size":"12px",padding:"2px 6px"}},{default:t(()=>[o(u(r.category),1)]),_:1})]),e(Y,{class:"pa-0"},{default:t(()=>[o(u(r.content[r.content.length-1].chapterName),1)]),_:1}),e(B,{class:"pa-0 ellipsis-3-lines"},{default:t(()=>[o(u(r.content[0].content[0]),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},M=ee(re,[["__scopeId","data-v-eade7f3b"]]),ne={class:"pa-0 px-4"},ce=i("h2",null,"收藏故事",-1),ue=i("h2",null,"熱門故事",-1),ie=i("h2",null,"最新故事",-1),de=i("h2",null,"完結故事",-1),pe={key:1,class:""},fe=i("h2",null,"創作資源區",-1),Ce={__name:"index",setup(r){const w=q(),{api:m,apiAuth:S}=J(),x=K(),E=()=>{w.isLogin?x.push("/createStory"):x.push("/login")},P=d([]),v=d([]),A=d([]),L=d([]),C=d([]),j=d(null),$=c=>{j.value=j.value===c?null:c},g=async()=>{try{const{data:c}=await m.get("/story");P.value=c.result.data;const[N,a,k]=await Promise.all([m.get("/story/getPopularStories"),m.get("/story/getNewestStories"),m.get("/story/getCompletedStories")]);if(A.value=N.data.result.data,L.value=a.data.result.data,C.value=k.data.result.data,w.isLogin){const G=await S.get("/story/getBookmarkStories");v.value=G.data.result.data}else v.value=[]}catch(c){console.error("Failed to load stories:",c)}},F=[{to:"/articleArea",icon:"mdi-lightbulb-on-outline",title:"創作指引",color:"#F9A825"}];return Q(()=>{g(),D.on("updateStory",g)}),X(()=>{D.off("updateStory",g)}),(c,N)=>(s(),n("div",null,[e(f,null,{default:t(()=>[e(l,{cols:"12"},{default:t(()=>[e(z,{class:"rounded-0 px-10 py-auto",height:"200px",color:"surface-variant",image:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=2948&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",cover:"",elevation:"5"},{default:t(()=>[e(l,null,{default:t(()=>[e(U,{class:"text-h4 font-weight-bold"},{default:t(()=>[o(" 歡迎來到界筆！ ")]),_:1}),e(B,{class:"font-weight-bold pa-0 py-2 px-4 mb-2",style:{"font-size":"24px","letter-spacing":"12px"}},{default:t(()=>[o(" 探索和創作無限可能的故事 ")]),_:1}),i("div",ne,[e(T,{class:"font-weight-black mr-3 px-4",variant:"elevated",color:"#CCB78E",onClick:E,to:"/createStory"},{default:t(()=>[o(" 立即創作 ")]),_:1}),e(T,{class:"font-weight-black px-4",outlined:"",border:"",variant:"elevated",style:{color:"#ccb78e",border:"1px solid #ccb78e","background-color":"rgba(0, 0, 0, 0.47)"},to:"/category"},{default:t(()=>[o(" 探索故事 ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),Z(w).isLogin?(s(),n(p,{key:0},[v.value.length>0?(s(),_(b,{key:0,style:{padding:"32px"}},{default:t(()=>[e(f,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ce]),_:1}),e(h,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-column justify-space-between"},{default:t(()=>[(s(!0),n(p,null,y(v.value,a=>(s(),_(I,V({key:a._id,ref_for:!0},a,{isExpanded:j.value===a._id,onToggle:k=>$(a._id),onUpdate:g}),null,16,["isExpanded","onToggle"]))),128))]),_:1})]),_:1})]),_:1})):R("",!0)],64)):R("",!0),e(b,{style:{padding:"32px"}},{default:t(()=>[e(f,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ue]),_:1}),e(h,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-start"},{default:t(()=>[(s(!0),n(p,null,y(A.value,a=>(s(),_(M,V({key:a._id,ref_for:!0},a),null,16))),128))]),_:1})]),_:1})]),_:1}),e(b,{style:{padding:"32px"}},{default:t(()=>[e(f,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ie]),_:1}),e(h,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-column justify-space-between"},{default:t(()=>[(s(!0),n(p,null,y(L.value,a=>(s(),_(I,V({key:a._id,ref_for:!0},a,{onUpdate:g}),null,16))),128))]),_:1})]),_:1})]),_:1}),e(b,{style:{padding:"32px"}},{default:t(()=>[e(f,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[de]),_:1}),e(h,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-space-between"},{default:t(()=>[C.value.length>0?(s(!0),n(p,{key:0},y(C.value,a=>(s(),_(M,V({key:a._id,ref_for:!0},a),null,16))),128)):(s(),n("div",pe,"尚未有已完結故事"))]),_:1})]),_:1})]),_:1}),e(b,{style:{padding:"32px"}},{default:t(()=>[e(f,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[fe]),_:1}),e(h,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-space-between py-0"},{default:t(()=>[e(ae,{class:"d-flex justify-space-between w-100 py-0",style:{"background-color":"transparent"}},{default:t(()=>[(s(),n(p,null,y(F,(a,k)=>e(se,{key:k,to:a.to,link:""},{prepend:t(()=>[e(O,{size:"80",color:a.color},{default:t(()=>[o(u(a.icon),1)]),_:2},1032,["color"])]),default:t(()=>[e(le,{style:{"font-size":"20px","font-weight":"bold"},textContent:u(a.title)},null,8,["textContent"])]),_:2},1032,["to"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{Ce as default};
