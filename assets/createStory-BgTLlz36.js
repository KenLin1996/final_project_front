import{p as le,aB as ae,aC as te,g as se,D as oe,aD as re,aE as ue,o as T,x as w,G,u as ie,aF as j,c as e,aG as ne,N as de,O as ce,P as d,Q as c,R as l,a8 as me,a0 as r,Z as m,T as u,aa as g,aH as V,ae as $,$ as a,S as fe,ad as pe,af as ve,ag as ge}from"./index-DwNFzC7S.js";import{c as Ve,d as xe,a as P,e as _e,f as E,u as ye,b as x}from"./vee-validate.esm-C13Q_be1.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as he}from"./VContainer-LkvkJRsm.js";import{V as we}from"./VDivider-DBwq-x9k.js";import{V as f,a as p}from"./VRow-NdwgLj6x.js";import{V as ke}from"./VTextarea-DRNRZ96f.js";import{V as A,a as H,b as D}from"./VRadioGroup-Bu8D-BLm.js";import{V as Se}from"./VForm-DjsAhpZd.js";import"./VList-CP1f_8yp.js";import"./VMenu-xaLXyozX.js";import"./VSelectionControl-Dtqyzzd8.js";import"./VChip-Cvg0Fcbk.js";import"./VSlideGroup-BbUVG1IY.js";const qe=le({id:String,text:String,...ae(te({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),Ce=se()({name:"VTooltip",props:qe(),emits:{"update:modelValue":o=>!0},setup(o,R){let{slots:b}=R;const k=oe(o,"modelValue"),{scopeId:h}=re(),N=ue(),n=T(()=>o.id||`v-tooltip-${N}`),U=w(),L=T(()=>o.location.split(" ").length>1?o.location:o.location+" center"),z=T(()=>o.origin==="auto"||o.origin==="overlap"||o.origin.split(" ").length>1||o.location.split(" ").length>1?o.origin:o.origin+" center"),O=T(()=>o.transition?o.transition:k.value?"scale-transition":"fade-transition"),C=T(()=>G({"aria-describedby":n.value},o.activatorProps));return ie(()=>{const M=j.filterProps(o);return e(j,G({ref:U,class:["v-tooltip",o.class],style:o.style,id:n.value},M,{modelValue:k.value,"onUpdate:modelValue":_=>k.value=_,transition:O.value,absolute:!0,location:L.value,origin:z.value,persistent:!0,role:"tooltip",activatorProps:C.value,_disableGlobalStack:!0},h),{activator:b.activator,default:function(){var q;for(var _=arguments.length,S=new Array(_),y=0;y<_;y++)S[y]=arguments[y];return((q=b.default)==null?void 0:q.call(b,...S))??o.text}})}),ne({},U)}}),Q=o=>(ve("data-v-efca5195"),o=o(),ge(),o),Me=Q(()=>r("h2",null,"我的故事",-1)),Te={class:"me-2"},Ne={class:"d-flex align-center"},Ue=Q(()=>r("div",{class:"tooltip-content"},[r("p",null,[r("strong",null,"詩")]),r("ul",null,[r("li",null,"短詩：50字以内"),r("li",null,"長詩：數百到數千字")]),r("p",null,[r("strong",null,"小說")]),r("ul",null,[r("li",null,"短篇小說：1,000到20,000字（通常3,000到7,500字之間）"),r("li",null,"中篇小說：20,000到50,000字"),r("li",null,"長篇小說：超過50,000字（通常80,000到120,000字之間）")]),r("p",null,[r("strong",null,"短品（散文、隨筆等）")]),r("ul",null,[r("li",null,"短篇散文：500到2,000字"),r("li",null,"隨筆：1,000到5,000字")])],-1)),ze={class:"d-flex align-center"},Fe={class:"d-flex align-center"},Pe={__name:"createStory",setup(o){const{apiAuth:R}=me(),b=de(),k=w(null),h=w([]),N=w([]),n=["totalWordCount","title","chapterName","content","category","chapterLabels","state","show","fileRecords"],U=Ve({totalWordCount:xe().required("文章總字數必填").typeError("文章總字數必須是數字").positive("文章總字數必須是正數").integer("文章總字數必須是整數"),title:P().required("故事名稱必填"),chapterName:P().required("章節名稱必填"),content:P().required("內容必填"),category:P().required("作品分類必填"),chapterLabels:_e().required("作品標籤必填"),state:E().required("狀態必填"),show:E().required("顯示方式必填")}),{handleSubmit:L,isSubmitting:z,resetForm:O}=ye({validationSchema:U,initialValues:{totalWordCount:1,title:"",chapterName:"",content:"",voteTime:0,category:"",chapterLabels:[],state:!1,show:!0}}),C=x("totalWordCount"),M=x("title"),_=x("chapterName"),S=x("content"),y=x("voteTime"),q=x("category"),W=x("chapterLabels"),B=x("state"),I=x("show"),Z=w(["文藝評論","商業理財","藝術設計","人文科普","心靈養生","生活風格","親子共享","傳記/文學史","羅曼史","校園愛情","武俠仙俠","歷史","驚悚推理","奇幻","恐怖靈異","影視","軍事戰爭/災難冒險","溫馨勵志/成長療癒","幽默/諷喻","同志","漫畫","同人","都市","玄幻","科幻","網遊","都會愛情","古代愛情","百合","其他"]),J=w(["不限","爽文","心情抒發","療癒","青梅竹馬","戰鬥","異界","戀愛","日常","校園","搞笑","後宮","異能","妖怪","妹控","節操","二創","百合","虐心","甜文","悲劇","喜劇","輕鬆","暗黑","清水","穿越","重生","靈異神怪","異國","冒險","女性向","男性向","輕小說","同志","恐怖"]),K=w([{title:"50 秒",value:1e3*50},{title:"10 分鐘",value:1e3*10*60},{title:"30 分鐘",value:1e3*30*60},{title:"1 小時",value:1e3*60*60},{title:"2 小時",value:1e3*2*60*60},{title:"4 小時",value:1e3*4*60*60},{title:"8 小時",value:1e3*8*60*60},{title:"12 小時",value:1e3*12*60*60},{title:"24 小時",value:1e3*24*60*60},{title:"36 小時",value:1e3*36*60*60}]),X=()=>{O(),k.value.deleteFileRecord()},Y=L(async v=>{var s,F,t;if(!((s=h.value[0])!=null&&s.error))try{const i=new FormData;i.append("totalWordCount",v.totalWordCount),i.append("title",v.title),i.append("chapterName",v.chapterName),i.append("content",v.content),i.append("voteTime",v.voteTime),i.append("category",v.category);for(const ee of v.chapterLabels)i.append("chapterLabels",ee);i.append("state",v.state),i.append("show",v.show),h.value.length>0&&i.append("image",h.value[0].file),await R.post("/story",i),b({text:"新增成功",snackbarProps:{color:"green"}}),X()}catch(i){console.log(i),b({text:((t=(F=i==null?void 0:i.response)==null?void 0:F.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}});return(v,s)=>{const F=ce("vue-file-agent");return d(),c(he,{style:{padding:"32px"}},{default:l(()=>[Me,e(we,{class:"mb-5"}),e(Se,{onSubmit:pe(a(Y),["prevent"]),disabled:a(z),style:{padding:"10px 20px"}},{default:l(()=>[e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center w-100"},{default:l(()=>[r("div",Te,[n.includes("totalWordCount")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("總字數")]),_:1})]),r("div",Ne,[e($,{"max-width":"600px",type:"number",class:"flex-grow-1",modelValue:a(C).value.value,"onUpdate:modelValue":s[0]||(s[0]=t=>a(C).value.value=t),"error-messages":a(C).errorMessage.value,required:""},null,8,["modelValue","error-messages"]),e(Ce,{location:"bottom"},{activator:l(({props:t})=>[e(m,G({class:"mdi mdi-lightbulb-outline"},t),null,16)]),default:l(()=>[Ue]),_:1})])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("title")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("故事名")]),_:1}),e($,{"max-width":"600px",class:"flex-grow-1",modelValue:a(M).value.value,"onUpdate:modelValue":s[1]||(s[1]=t=>a(M).value.value=t),"error-messages":a(M).errorMessage.value,required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("chapterName")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("章節名稱")]),_:1}),e($,{class:"flex-grow-1",modelValue:a(_).value.value,"onUpdate:modelValue":s[2]||(s[2]=t=>a(_).value.value=t),"error-messages":a(_).errorMessage.value,required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("content")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("起始故事")]),_:1}),e(ke,{class:"flex-grow-1",counter:30,modelValue:a(S).value.value,"onUpdate:modelValue":s[3]||(s[3]=t=>a(S).value.value=t),"error-messages":a(S).errorMessage.value,required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("category")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("投票時間")]),_:1}),e(A,{class:"flex-grow-1","hide-details":"",modelValue:a(y).value.value,"onUpdate:modelValue":s[4]||(s[4]=t=>a(y).value.value=t),"error-messages":a(y).errorMessage.value,items:K.value,required:""},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("category")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("作品分類")]),_:1}),e(A,{class:"flex-grow-1","hide-details":"",modelValue:a(q).value.value,"onUpdate:modelValue":s[5]||(s[5]=t=>a(q).value.value=t),"error-messages":a(q).errorMessage.value,items:Z.value,required:""},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("chapterLabels")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("作品標籤")]),_:1}),e(A,{class:"flex-grow-1",multiple:"",chips:"","hide-details":"",modelValue:a(W).value.value,"onUpdate:modelValue":s[6]||(s[6]=t=>a(W).value.value=t),"error-messages":a(W).errorMessage.value,items:J.value,required:""},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("state")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("故事狀態")]),_:1}),e(H,{class:"d-flex align-center flex-grow-2",row:"","hide-details":"",modelValue:a(B).value.value,"onUpdate:modelValue":s[7]||(s[7]=t=>a(B).value.value=t),"error-messages":a(B).errorMessage.value},{default:l(()=>[r("div",ze,[e(D,{label:"連載中",value:!1})])]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("show")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px"},{default:l(()=>[u("mdi-asterisk")]),_:1})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("顯示方式")]),_:1}),e(H,{class:"d-flex align-center flex-grow-1",row:"","hide-details":"",modelValue:a(I).value.value,"onUpdate:modelValue":s[8]||(s[8]=t=>a(I).value.value=t),"error-messages":a(I).errorMessage.value},{default:l(()=>[r("div",Fe,[e(D,{label:"公開",value:!0,class:"me-4"}),e(D,{label:"隱藏",value:!1})])]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex align-center"},{default:l(()=>[n.includes("fileRecords")?(d(),c(m,{key:0,class:"me-2",style:{color:"red"},size:"12px",icon:"mdi-asterisk"})):g("",!0),e(V,{class:"me-4 mb-0"},{default:l(()=>[u("封面圖片")]),_:1}),e(F,{modelValue:h.value,"onUpdate:modelValue":s[9]||(s[9]=t=>h.value=t),"raw-model-value":N.value,"onUpdate:rawModelValue":s[10]||(s[10]=t=>N.value=t),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:k},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(p,{cols:"12",class:"d-flex justify-center"},{default:l(()=>[e(fe,{type:"submit",loading:a(z),style:{"background-color":"#4e9194",color:"#ffffff"}},{default:l(()=>[u("發布")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})}}},Ze=be(Pe,[["__scopeId","data-v-efca5195"]]);export{Ze as default};
