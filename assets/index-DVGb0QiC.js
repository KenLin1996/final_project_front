import{a6 as G,a7 as s,aa as i,ac as t,c as e,ao as M,ap as B,ae as o,ah as u,V as H,ad as d,aq as E,ar as $,a2 as q,x as g,A as J,as as W,J as z,a9 as Y,a8 as c,P as p,ag as y,ai as D,at as K,a5 as O,G as V,ak as Q}from"./index-Bzmhv8R7.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Z}from"./VChip-DDXFAH8t.js";import{m as I,S as R}from"./StoryItem-BZbCqCCj.js";import{V as f}from"./VContainer-cMmaaPYi.js";import{V as l,a as _}from"./VRow-BUWxvBY3.js";import{V as b}from"./VDivider-BRp88LzG.js";import{a as ee,V as te,b as ae}from"./VList-CEYxBDgr.js";import"./VSlideGroup-DNihUQjE.js";import"./vee-validate.esm-BtqnpI9n.js";import"./VMenu-CVES9l16.js";import"./VTextarea-B7oIb8io.js";const se={class:"d-flex justify-space-between align-center my-2"},le={__name:"BookCard",props:["_id","image","title","category","mainAuthor","content","chapterName"],setup(r){return(h,w)=>{const S=G("router-link");return s(),i(S,{to:"/stories/"+r._id,style:{"text-decoration":"none"}},{default:t(()=>[e(M,{class:"pa-3 customMargin h-100 me-2 pa-4 rounded-lg",width:"220",style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, 0.2), 0 4px 8px rgba(0, 0, 0, 0.15)"}},{default:t(()=>[e(B,{class:"pa-0 mb-2 cursor-pointer",style:{"font-size":"12px",color:"#4e9194"}},{default:t(()=>{var m;return[o(u((m=r.mainAuthor)==null?void 0:m.username),1)]}),_:1}),e(H,{class:"cursor-pointer rounded-lg",height:"160px",src:r.image,cover:"",style:{"box-shadow":"0 2px 4px rgba(0, 0, 0, 0.2)"}},null,8,["src"]),d("div",se,[e(E,{class:"pa-0 text-subtitle-1 cursor-pointer",style:{width:"130px"}},{default:t(()=>[o(u(r.title),1)]),_:1}),e(Z,{density:"compact",color:"primary",label:"",style:{"font-size":"12px",padding:"2px 6px"}},{default:t(()=>[o(u(r.category),1)]),_:1})]),e($,{class:"pa-0"},{default:t(()=>[o(u(r.content[r.content.length-1].chapterName),1)]),_:1}),e(B,{class:"pa-0 ellipsis-3-lines"},{default:t(()=>[o(u(r.content[0].content[0]),1)]),_:1})]),_:1})]),_:1},8,["to"])}}},T=X(le,[["__scopeId","data-v-eade7f3b"]]),oe={class:"pa-0 px-4"},re=d("h2",null,"收藏故事",-1),ne=d("h2",null,"熱門故事",-1),ce=d("h2",null,"最新故事",-1),ie=d("h2",null,"完結故事",-1),ue={key:1,class:""},de=d("h2",null,"創作資源區",-1),Ve={__name:"index",setup(r){const h=q(),{api:w,apiAuth:S}=K(),m=O(),P=()=>{h.isLogin?m.push("/createStory"):m.push("/login")},v=g([]),A=g([]),L=g([]),C=g([]),j=g(null),U=n=>{j.value=j.value===n?null:n},x=async()=>{try{const[n,N,a]=await Promise.all([w.get("/story/getPopularStories"),w.get("/story/getNewestStories"),w.get("/story/getCompletedStories")]);if(A.value=n.data.result.data,L.value=N.data.result.data,C.value=a.data.result.data,h.isLogin){const k=await S.get("/story/getBookmarkStories");v.value=k.data.result.data}else v.value=[]}catch(n){console.error("Failed to load stories:",n)}},F=[{to:"/articleArea",icon:"mdi-lightbulb-on-outline",title:"創作指引",color:"#F9A825"}];return J(()=>{x(),I.on("updateStory",x)}),W(()=>{I.off("updateStory",x)}),(n,N)=>(s(),i(f,{class:"ma-0 bg-white",style:{"max-width":"100vw"}},{default:t(()=>[e(_,null,{default:t(()=>[e(l,{cols:"12",class:"pa-0"},{default:t(()=>[e(M,{class:"rounded-0 px-10 py-auto rounded-lg",height:"200px",color:"surface-variant",image:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=2948&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",cover:"",elevation:"5"},{default:t(()=>[e(l,null,{default:t(()=>[e(E,{class:"text-h4 font-weight-bold",style:{"font-size":"2rem"}},{default:t(()=>[o(" 歡迎來到界筆！ ")]),_:1}),e(B,{class:"font-weight-bold pa-0 pb-2 px-4 mb-2",style:{"font-size":"1rem","letter-spacing":"12px"}},{default:t(()=>[o(" 探索和創作無限可能的故事 ")]),_:1}),d("div",oe,[e(z,{class:"font-weight-black mr-3 px-4",variant:"elevated",color:"#CCB78E",onClick:P,to:"/createStory"},{default:t(()=>[o(" 立即創作 ")]),_:1}),e(z,{class:"font-weight-black px-4",outlined:"",border:"",variant:"elevated",style:{color:"#ccb78e",border:"1px solid #ccb78e","background-color":"rgba(0, 0, 0, 0.47)"},to:"/category"},{default:t(()=>[o(" 探索故事 ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),Y(h).isLogin?(s(),c(p,{key:0},[v.value.length>0?(s(),i(f,{key:0,style:{padding:"32px"}},{default:t(()=>[e(_,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[re]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-column justify-space-between"},{default:t(()=>[(s(!0),c(p,null,y(v.value,a=>(s(),i(R,V({key:a._id,ref_for:!0},a,{isExpanded:j.value===a._id,onToggle:k=>U(a._id),onUpdate:x}),null,16,["isExpanded","onToggle"]))),128))]),_:1})]),_:1})]),_:1})):D("",!0)],64)):D("",!0),e(f,{style:{padding:"32px","max-width":"98%"},class:""},{default:t(()=>[e(_,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ne]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-start"},{default:t(()=>[(s(!0),c(p,null,y(A.value,a=>(s(),i(T,V({key:a._id,ref_for:!0},a),null,16))),128))]),_:1})]),_:1})]),_:1}),e(f,{style:{padding:"32px"}},{default:t(()=>[e(_,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ce]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-column justify-space-between"},{default:t(()=>[(s(!0),c(p,null,y(L.value,a=>(s(),i(R,V({key:a._id,ref_for:!0},a,{onUpdate:x}),null,16))),128))]),_:1})]),_:1})]),_:1}),e(f,{style:{padding:"32px"}},{default:t(()=>[e(_,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[ie]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-space-between"},{default:t(()=>[C.value.length>0?(s(!0),c(p,{key:0},y(C.value,a=>(s(),i(T,V({key:a._id,ref_for:!0},a),null,16))),128)):(s(),c("div",ue,"尚未有已完結故事"))]),_:1})]),_:1})]),_:1}),e(f,{style:{padding:"32px"}},{default:t(()=>[e(_,{class:"justify-space-between"},{default:t(()=>[e(l,{cols:"12",class:"pb-0"},{default:t(()=>[de]),_:1}),e(b,{class:"mb-3"}),e(l,{cols:"12",class:"d-flex flex-row justify-space-between py-0"},{default:t(()=>[e(ee,{class:"d-flex justify-space-between w-100 py-0",style:{"background-color":"transparent"}},{default:t(()=>[(s(),c(p,null,y(F,(a,k)=>e(te,{key:k,to:a.to,link:""},{prepend:t(()=>[e(Q,{size:"80",color:a.color},{default:t(()=>[o(u(a.icon),1)]),_:2},1032,["color"])]),default:t(()=>[e(ae,{style:{"font-size":"20px","font-weight":"bold"},textContent:u(a.title)},null,8,["textContent"])]),_:2},1032,["to"])),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Ve as default};
